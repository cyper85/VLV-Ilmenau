<VirtualHost *:80>
	ServerName vlv-ilmenau.de
	ServerAlias www.vlv-ilmenau.de
	
	ServerAdmin webmaster@vlv-ilmenau.de
	DocumentRoot /var/www/html/uni

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	<Files "login.php">
		RewriteEngine On
	        RedirectMatch ^(.*)$ https://vlv-ilmenau.de$1
	</Files>
	<Files "test.php">
		AuthType shibboleth
		ShibRequireSession On
		require shibboleth
	</Files>
	
	RewriteEngine On
	RewriteCond %{HTTPS} off
	RewriteRule ^/(login.*) https://%{HTTP_HOST}/$1 [L,R]
	RewriteRule ^/(password.*) https://%{HTTP_HOST}/$1 [L,R]
	RewriteRule ^/(settings.*) https://%{HTTP_HOST}/$1 [L,R]
	RewriteRule ^/(register.*) https://%{HTTP_HOST}/$1 [L,R]
	
	Alias /sitemap.xml /var/www/html/uni/sitemap.php
	Alias /vlv.php /var/www/html/uni/index.php

	Header set PICS-Label: '(PICS-1.1 "http://vancouver-webpages.com/VWP1.0/" l gen true by "webmaster@vlv-ilmenau.de" on "2014.11.03T08:59-0800" for "http://vlv-ilmenau.de" r (Gam 0 V 1 Env 0 SF 0 Com 1 Can 0 Edu -1 S 0 P 1 Tol 0 MC 0 ))'
	
</VirtualHost>

<VirtualHost *:443>
	ServerName vlv-ilmenau.de
	ServerAlias www.vlv-ilmenau.de
	
	ServerAdmin webmaster@vlv-ilmenau.de
	DocumentRoot /var/www/html/uni

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	SSLEngine on

	SSLCertificateFile	/etc/letsencrypt/live/vlv-ilmenau.de/cert.pem
	SSLCertificateKeyFile	/etc/letsencrypt/live/vlv-ilmenau.de/privkey.pem
	SSLCertificateChainFile	/etc/letsencrypt/live/vlv-ilmenau.de/fullchain.pem

#	SSLCertificateFile	/etc/ssl/certs/vlv-ilmenau.de_crt.pem
#	SSLCertificateKeyFile /etc/ssl/private/vlv-ilmenau.de_privatekey.pem
#	SSLCARevocationPath /etc/ssl/crl/
#	SSLCARevocationCheck chain
	
	<FilesMatch "test.php$">
		AuthType shibboleth
		ShibRequireSession On
		require shibboleth
	</FilesMatch>
	
	Alias /sitemap.xml /var/www/html/uni/sitemap.php
        Alias /vlv.php /var/www/html/uni/index.php

	Header set PICS-Label: '(PICS-1.1 "http://vancouver-webpages.com/VWP1.0/" l gen true by "webmaster@vlv-ilmenau.de" on "2014.11.03T08:59-0800" for "http://vlv-ilmenau.de" r (Gam 0 V 1 Env 0 SF 0 Com 1 Can 0 Edu -1 S 0 P 1 Tol 0 MC 0 ))'
	Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
